<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="/assets/styles.css">
    <link rel="stylesheet" href="/assets/notes.css">
    <link rel="stylesheet" href="/assets/hljs-github.css">
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        messageStyle: "none",
        tex2jax: {
          inlineMath: [["$", "$"], ["\\(", "\\)"]],
          processEscapes: true
        },
        "HTML-CSS": {
          availableFonts: ["TeX"]
        }
      });
    </script>
    <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  </head>
  <body>
    <div class="content"><h1 id="mathematica">Mathematica</h1>
<pre><code>Clear[&quot;Global`*&quot;]
</code></pre><h2 id="no-notebook">No notebook</h2>
<pre><code class="sh">$ math -noprompt -run &lt; code.txt
$ math -noprompt -run <span class="hljs-string">"&lt;&lt;test.txt; Exit[];"</span>
$ math -noprompt -run <span class="hljs-string">"Print[TeXForm[Integrate[Cos[x], x]]]; Exit[];"</span>
$ <span class="hljs-built_in">echo</span> <span class="hljs-_">-e</span> <span class="hljs-string">"TeXForm[Integrate[Cos[x], x]]\nExit[]"</span> | math -noprompt -run
$ math -script code.txt
</code></pre>
<ul>
<li><code>-run</code> treats <code>code.txt</code> as a notebook while <code>-script</code> treats <code>code.txt</code> like “ordinary code”.</li>
<li><code>-script</code> requires <code>Print[..]</code> for output while <code>-run</code> does not if reading from file (not stdinput).</li>
<li><code>-script</code> does not support <code>TeXForm</code> and <code>MatrixForm</code>.</li>
</ul>
<h2 id="quantum-information">Quantum information</h2>
<h3 id="bras-and-kets">Bras and kets</h3>
<pre><code class="mathematica">bra[str_] := {Flatten[Apply[TensorProduct, Map[If[#1 == "0", {1, 0}, {0, 1}] &amp;, <span class="hljs-keyword">Characters</span>[str]]]]};
ket[str_] := <span class="hljs-keyword">Transpose</span>[bra[str]];
</code></pre>
<p><strong>Usage example:</strong></p>
<pre><code class="mathematica">bra[<span class="hljs-string">"010"</span>] <span class="hljs-comment">(* row vector: {{0, 0, 1, 0, 0, 0, 0, 0}} *)</span>
ket[<span class="hljs-string">"010"</span>] <span class="hljs-comment">(* col vector: {{0}, {0}, {1}, {0}, {0}, {0}, {0}, {0}} *)</span>
bra[<span class="hljs-string">"000"</span>].ket[<span class="hljs-string">"001"</span>] <span class="hljs-comment">(* 0 *)</span>
bra[<span class="hljs-string">"000"</span>].ket[<span class="hljs-string">"000"</span>] <span class="hljs-comment">(* 1 *)</span>
ket[<span class="hljs-string">"000"</span>].bra[<span class="hljs-string">"000"</span>] <span class="hljs-comment">(* the correct matrix *)</span>
<span class="hljs-keyword">ConjugateTranspose</span>[ket[<span class="hljs-string">"010"</span>]] == bra[<span class="hljs-string">"010"</span>] <span class="hljs-comment">(* True *)</span>
</code></pre>
<h3 id="partial-trace">Partial trace</h3>
<p>The partial trace $\mathrm{tr}_\alpha(\rho)$ can be computed with</p>
<p>\begin{equation}
  \operatorname{tr}_1(A_{12}) = \sum_i \langle i \rvert_1 A_{12} \lvert i \rangle_1 = \sum_i (\langle i \rvert \otimes I) \rvert A_{12} (\lvert i \rangle \otimes I)
\end{equation}</p>
<p>which can be implemented as</p>
<pre><code class="mathematica">pTr[mat_, k_] := <span class="hljs-keyword">Module</span>[{n, indices, bbra, kket},
  n = <span class="hljs-keyword">Log</span>[<span class="hljs-number">2</span>, <span class="hljs-keyword">Dimensions</span>[mat][[<span class="hljs-number">1</span>]]];
  indices = <span class="hljs-keyword">Characters</span>[<span class="hljs-keyword">Table</span>[<span class="hljs-keyword">IntegerString</span>[j, <span class="hljs-number">2</span>, n - <span class="hljs-number">1</span>], {j, 0, 2^(n - 1) - 1}]];
  <span class="hljs-comment">(* bbra = |i&gt;⊗I *)</span>
  bbra[i_] := <span class="hljs-keyword">Module</span>[{jj},
    jj = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">Apply</span>[<span class="hljs-keyword">KroneckerProduct</span>, <span class="hljs-keyword">Table</span>[
      <span class="hljs-keyword">If</span>[
        <span class="hljs-keyword">MemberQ</span>[k, j] ∨ j == k,
        jj++; bra[i[[jj]]],
        <span class="hljs-keyword">IdentityMatrix</span>[<span class="hljs-number">2</span>]
      ], {j, 1, n}]]];
  <span class="hljs-keyword">Sum</span>[bbra[i] . mat . <span class="hljs-keyword">ConjugateTranspose</span>[bbra[i]], {i, indices}]];
</code></pre>
<p><strong>Usage:</strong></p>
<pre><code class="mathematica">pTr(ρ, <span class="hljs-number">2</span>)     <span class="hljs-comment">(* trace out subsystem 2 *)</span>
pTr(ρ, {2})   <span class="hljs-comment">(* trace out subsystem 2 *)</span>
pTr(ρ, {1,2}) <span class="hljs-comment">(* trace out subsystem 1 and 2)</span>
</code></pre>
<p><strong>Example:</strong></p>
<p>Consider three qubits. The state space is the hilbert space $\mathcal{H}_1\otimes\mathcal{H}_2\otimes\mathcal{H}_3$. A state can be written $\lvert\psi\rangle = c_0\lvert 000\rangle + c_1\lvert 001\rangle + \cdots + c_7\lvert 111\rangle$. The corresponding (pure) density matrix is then $\rho = \lvert\psi\rangle \langle\psi\rvert$. The corresponding reduced density operator $\rho_1 = \operatorname{tr}_{23}(\rho)$ is</p>
<pre><code class="mathematica"><span class="hljs-keyword">$Assumptions</span> = {α ∈ Reals, β ∈ Reals};
ψ = <span class="hljs-keyword">Sqrt</span>[<span class="hljs-number">2</span>/<span class="hljs-number">3</span>] (α ket[<span class="hljs-string">"000"</span>] - β ket[<span class="hljs-string">"111"</span>]) -
         α/<span class="hljs-keyword">Sqrt</span>[<span class="hljs-number">6</span>] (ket[<span class="hljs-string">"011"</span>] + ket[<span class="hljs-string">"101"</span>]) +
         β/<span class="hljs-keyword">Sqrt</span>[<span class="hljs-number">6</span>] (ket[<span class="hljs-string">"010"</span>] + ket[<span class="hljs-string">"100"</span>]);
ρ = ψ.<span class="hljs-keyword">ConjugateTranspose</span>[ψ] // <span class="hljs-keyword">FullSimplify</span>;
ρ // <span class="hljs-keyword">MatrixForm</span>
ρ<span class="hljs-number">1</span> = pTr[ρ, {2,3}] // <span class="hljs-keyword">FullSimplify</span> // <span class="hljs-keyword">Expand</span> // <span class="hljs-keyword">MatrixForm</span>
</code></pre>
<h2 id="misc">Misc.</h2>
<p>Parse LaTeX:</p>
<pre><code class="mathematica"><span class="hljs-keyword">ToExpression</span>[<span class="hljs-string">"\\sqrt{x y}"</span>, <span class="hljs-keyword">TeXForm</span>]
</code></pre>
<p>Separate contexts/scopes for notebooks: <a href="http://stackoverflow.com/a/4897013">http://stackoverflow.com/a/4897013</a></p>
</div>
    <!-- <div class="footer-separator"></div> -->
    <!-- <div class="footer"><div class="footer-inner">Viktor Qvarfordt</div></div> -->
  </body>
</html>
