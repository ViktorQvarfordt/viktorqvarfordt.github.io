<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="/assets/styles.css">
    <link rel="stylesheet" href="/assets/notes.css">
    <link rel="stylesheet" href="/assets/hljs-github.css">
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        messageStyle: "none",
        tex2jax: {
          inlineMath: [["$", "$"], ["\\(", "\\)"]],
          processEscapes: true
        },
        "HTML-CSS": {
          availableFonts: ["TeX"]
        }
      });
    </script>
    <script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
  </head>
  <body>
    <div class="content"><h1 id="user-scripts">User scripts</h1>
<p>Consult <a href="http://wiki.greasespot.net/Metadata_Block">this</a> for how to customize the meta block, in particular the include and exclude <a href="http://wiki.greasespot.net/Include_and_exclude_rules">rules</a>.</p>
<ul>
<li><a href="#google-search-tweaks">Google search tweaks</a></li>
<li><a href="#mathjax-on-any-website">MathJax on any website</a></li>
</ul>
<h2 id="google-search-tweaks">Google search tweaks</h2>
<pre><code class="js"><span class="hljs-comment">// ==UserScript==</span>
<span class="hljs-comment">// @name        Google search tweaks</span>
<span class="hljs-comment">// @description Blocks ads and sponsored links. Adds shortcuts for selecting search results.</span>
<span class="hljs-comment">// @author      Viktor Qvarfordt</span>
<span class="hljs-comment">// @match       https://www.google.se/search*</span>
<span class="hljs-comment">// @version     2016-02-06</span>
<span class="hljs-comment">// @grant       none</span>
<span class="hljs-comment">// ==/UserScript==</span>
<span class="hljs-meta">
'use strict'</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addGlobalStyle</span>(<span class="hljs-params">css</span>) </span>{
  <span class="hljs-keyword">const</span> head = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>]
  <span class="hljs-keyword">if</span> (!head) { <span class="hljs-keyword">return</span>; }
  <span class="hljs-keyword">const</span> style = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'style'</span>)
  style.type = <span class="hljs-string">'text/css'</span>
  style.innerHTML = css
  head.appendChild(style)
}

<span class="hljs-comment">// Attempt to hide ads.</span>
addGlobalStyle(<span class="hljs-string">`
  iframe[name='google_ads_frame'],
  a[href^='http://pagead2.googlesyndication.com'] {
    display: none ! important;
  }`</span>)

<span class="hljs-comment">// Remove ad search results.</span>
tvcap.remove()

<span class="hljs-comment">// Shortcuts for selecting search results.</span>
<span class="hljs-keyword">const</span> gs = <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">'g'</span>)
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; gs.length &amp;&amp; i &lt; <span class="hljs-number">9</span>; i++) {
  gs[i].style.position = <span class="hljs-string">'relative'</span>
  gs[i].innerHTML = <span class="hljs-string">`&lt;span style="position: absolute; left: -20px; top: 4px;"&gt;<span class="hljs-subst">${i+1}</span>&lt;/span&gt;<span class="hljs-subst">${gs[i].innerHTML}</span>`</span>
  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'keydown'</span>, e =&gt; {
      <span class="hljs-keyword">if</span> (e.keyCode === <span class="hljs-built_in">String</span>(i+<span class="hljs-number">1</span>).charCodeAt(<span class="hljs-number">0</span>) || (e.keyCode === <span class="hljs-number">13</span> &amp;&amp; i === <span class="hljs-number">0</span>)) {
        <span class="hljs-keyword">const</span> link = gs[i].querySelector(<span class="hljs-string">'.r a'</span>)
        link.style[<span class="hljs-string">'font-weight'</span>] = <span class="hljs-string">'bold'</span>
        <span class="hljs-built_in">window</span>.location = link.href
      }
  })
}

<span class="hljs-comment">// ...but not from the search bar.</span>
<span class="hljs-built_in">window</span>[<span class="hljs-string">'lst-ib'</span>].addEventListener(<span class="hljs-string">'keydown'</span>, e =&gt; e.stopPropagation())
</code></pre>
<h2 id="mathjax-on-any-website">MathJax on any website</h2>
<pre><code class="js"><span class="hljs-comment">// ==UserScript==</span>
<span class="hljs-comment">// @name        MathJax Trello</span>
<span class="hljs-comment">// @description    Apply Mathjax to Trello</span>
<span class="hljs-comment">// @include     https://trello.com/*</span>
<span class="hljs-comment">// @grant       none</span>
<span class="hljs-comment">// ==/UserScript==</span>

<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.MathJax === <span class="hljs-literal">undefined</span>) {
  <span class="hljs-keyword">var</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);
  script.type = <span class="hljs-string">"text/javascript"</span>;
  script.src = <span class="hljs-string">"https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"</span>;
  script.text = <span class="hljs-string">'MathJax.Hub.Config({'</span>
              + <span class="hljs-string">'  messageStyle: "none",'</span>
              + <span class="hljs-string">'  tex2jax: {'</span>
              + <span class="hljs-string">'    inlineMath: [["$", "$"], ["\\\\(", "\\\\)"]],'</span>
              + <span class="hljs-string">'    processEscapes: true'</span>
              + <span class="hljs-string">'  },'</span>
              + <span class="hljs-string">'  "HTML-CSS": {'</span>
              + <span class="hljs-string">'    availableFonts: ["TeX"]'</span>
              + <span class="hljs-string">'  }'</span>
              + <span class="hljs-string">'});'</span>
              <span class="hljs-comment">// Run mathjax every second (the overhead is very low).</span>
              + <span class="hljs-string">'(function doMathJax() {'</span>
              + <span class="hljs-string">'  window.setTimeout(doMathJax, 1000);'</span>
              + <span class="hljs-string">'  window.MathJax.Hub.Queue(["Typeset", window.MathJax.Hub]);'</span>
              + <span class="hljs-string">'})();'</span>;
  <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"head"</span>)[<span class="hljs-number">0</span>].appendChild(script);
} <span class="hljs-keyword">else</span> {
  MathJax.Hub.Queue([<span class="hljs-string">"Typeset"</span>, MathJax.Hub]);
}
</code></pre>
</div>
    <!-- <div class="footer-separator"></div> -->
    <!-- <div class="footer"><div class="footer-inner">Viktor Qvarfordt</div></div> -->
  </body>
</html>
